"use strict";(self.webpackChunklabor_live=self.webpackChunklabor_live||[]).push([[111],{5296:(e,n,t)=>{t.d(n,{Z:()=>v});var i=t(5759),o=t(5684),a=t(1751),r=(t(4333),t(2300)),l=(0,i.H)(),s=(0,o.Jk)(l),u=s.liveId,c=s.userId,d={websocket:null,connectURL:"wss://websocket.qdszgh.cn:8443/jeecg-boot/testLiveWebsocket/"+u.value+"/"+c.value,socket_open:!1,hearbeat_timer:null,hearbeat_interval:6e4,is_reconnect:!0,reconnect_count:3,reconnect_current:1,reconnect_number:0,reconnect_timer:null,reconnect_interval:5e3,init:function(e){if(!("WebSocket"in window))return a.Z.fail("浏览器不支持websocket"),null;d.websocket=new WebSocket(d.connectURL),d.websocket.onmessage=function(n){e&&e(n)},d.websocket.onclose=function(e){clearInterval(d.hearbeat_interval),d.socket_open=!1,d.is_reconnect&&(d.reconnect_timer=setTimeout((function(){if(d.reconnect_current>d.reconnect_count)return clearTimeout(d.reconnect_timer),void(d.is_reconnect=!1);d.reconnect_current++,d.reconnect()}),d.reconnect_interval))},d.websocket.onopen=function(){d.socket_open=!0,d.is_reconnect=!0,d.heartbeat()},d.websocket.onerror=function(){}},send:function(e,n){void 0===n&&(n=null),d.websocket.readyState==d.websocket.OPEN?(d.websocket.send(JSON.stringify(e)),n&&n()):(clearInterval(d.hearbeat_timer),d.reconnect_number,d.reconnect_number++)},receive:function(e){var n=r.DS.decode(JSON.parse(e.data));return n=JSON.parse(n)},heartbeat:function(){d.hearbeat_timer&&clearInterval(d.hearbeat_timer),d.hearbeat_timer=setInterval((function(){var e={encryption_type:"base64",data:r.DS.encode(JSON.stringify({content:"ping"}))};d.send(e)}),d.hearbeat_interval)},close:function(){clearInterval(d.hearbeat_interval),d.is_reconnect=!1,d.websocket.close()},reconnect:function(){d.websocket&&!d.is_reconnect&&d.close(),d.init(null)}};const v=d},111:(e,n,t)=>{t.r(n),t.d(n,{default:()=>N});var i=t(6252),o=t(3577),a=function(e){return(0,i.dD)("data-v-96226a50"),e=e(),(0,i.Cn)(),e},r={action:"/"},l=a((function(){return(0,i._)("div",{style:{height:"8px",background:"#f5f5f5"}},null,-1)})),s={style:{display:"flex","align-items":"center","justify-content":"space-between"}},u={style:{display:"flex"}},c={style:{position:"relative"}},d=["src"],v={style:{"margin-left":"12px"}},f={class:"fsize14",style:{"padding-top":"5px"}},p={class:"fsize12",style:{"margin-top":"12px"}},g={style:{"padding-bottom":"23px","text-align":"center"}},h=a((function(){return(0,i._)("div",{class:"pop-title"},"提示",-1)})),m={class:"pop-content"},A=(0,i.Uk)("取消"),b=(0,i.Uk)("确定");var w=t(655),k=t(2262),y=t(1751),x=(t(4333),t(5296)),S=t(1610),I=t(5759),C=t(5684),_=t(3476),F=t(7872);const R={name:"MuteManage",setup:function(){var e=this,n=(0,i.FN)().appContext.config.globalProperties.$axios,t=(0,I.H)(),o=(0,C.Jk)(t).liveId,a=(0,k.qj)({superManageSign:_,generalManageSign:F,userList:[],liveId:(0,k.iH)("")});a.liveId=o.value;var r={name:"张先生",label:"张先生",phone:"133",userId:"2222",action:1},l=(0,k.iH)(!1),s=(0,k.iH)(""),u=function(){l.value=!1},c=function(e,t){console.log(e+"--"+r.name);var i={liveId:a.liveId,sendType:t,userId:e};(0,S.v_)(n.defaults.baseURL+"/jeecg-boot/api/liveAdmin/edit",i).then((function(e){200==e.data.code?(v.value=!1,u(),p.value=!0,A()):500==e.data.code&&(v.value=!1,(0,y.Z)(e.data.message))}))},d=(0,k.iH)(!1),v=(0,k.iH)(!1),f=(0,k.iH)(!1),p=(0,k.iH)(!1),g=(0,k.iH)(0),h=function(){p.value&&(a.userList=[],g.value=0,p.value=!1),g.value++,m({pageNo:g.value,pageSize:10,liveId:a.liveId})};function m(e){(0,S.U2)(n.defaults.baseURL+"/jeecg-boot/api/liveAdmin/list",e).then((function(e){if(200==e.data.code&&e.data.result){var n=e.data.result;console.log("luckyList",n);var t=n.records;if(t.length>0)for(var i=0;i<t.length;i++)a.userList.push(t[i]);console.log("当前页："+g.value),d.value=!1,g.value>=n.pages&&(f.value=!0)}else f.value=!0,d.value=!1}))}var A=function(){f.value=!1,d.value=!0,h()};function b(e){return new Promise((function(n,t){setTimeout((function(){R(e),n("success")}),500)}))}function R(e){console.log("socket receiver:<<<"+JSON.stringify(e)),a.userList.push(e),(0,i.Y3)((function(){f.value=!0,d.value=!1}))}return(0,i.bv)((function(){return(0,w.mG)(e,void 0,void 0,(function(){return(0,w.Jh)(this,(function(e){return console.log("onmounted"),[2]}))}))})),(0,w.pi)((0,w.pi)({},(0,k.BK)(a)),{receiveMessage:function(e){return(0,w.mG)(this,void 0,void 0,(function(){var n,t,i;return(0,w.Jh)(this,(function(o){switch(o.label){case 0:return n=JSON.parse(e.data),t=JSON.parse(JSON.stringify(n)),console.log("socket receiver:<<< "+JSON.stringify(t)),i={id:Date.now(),avatar:t.avatar,handlerName:n.handlerName,liveId:n.liveId,message:n.message,messageType:n.messageType,pushType:n.pushType,realname:n.realname},2!=t.pushType?[3,2]:[4,b(i)];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))},addTimeOut:b,addUser:R,enableMute:function(e,n){return(0,w.mG)(this,void 0,void 0,(function(){var t;return(0,w.Jh)(this,(function(i){return t={liveId:a.liveId,userId:e,sendType:n,pushType:"2"},x.Z.send(t),setTimeout((function(){v.value=!1,u(),p.value=!0,A()}),500),[2]}))}))},loadData:m,currentPage:g,onClickLeft:function(){return history.back()},value:s,onSearch:function(e){var n={pageNo:1,pageSize:10,liveId:a.liveId,fullName:e};a.userList=[],m(n)},onCancel:function(){return(0,y.Z)("取消")},currentPeople:r,onLoad:h,loading:d,buttonLoading:v,finished:f,onRefresh:A,refreshing:p,show:l,showPopup:function(e){l.value=!0,r.userId=e.userId,r.name=e.fullName,0==e.isForbiddenWords&&1==e.isAdmin?(r.action=1,r.label="确定解除“"+e.fullName+"”的管理员身份，并禁言吗？"):1==e.isForbiddenWords?(r.action=2,r.label="确定解除对“"+e.fullName+"”的禁言吗？"):0==e.isForbiddenWords&&(r.action=3,r.label="确定对“"+e.fullName+"”禁言吗？")},hidePopup:u,updateRole:function(){v.value=!0,1==r.action?c(r.userId,"3"):2==r.action?c(r.userId,"5"):3==r.action&&c(r.userId,"1")}})}};const N=(0,t(3744).Z)(R,[["render",function(e,n,t,a,w,k){var y=(0,i.up)("van-nav-bar"),x=(0,i.up)("van-search"),S=(0,i.up)("van-image"),I=(0,i.up)("van-button"),C=(0,i.up)("van-cell"),_=(0,i.up)("van-list"),F=(0,i.up)("van-pull-refresh"),R=(0,i.up)("van-popup");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(y,{class:"title",title:"禁言管理","left-text":"","left-arrow":"",onClickLeft:a.onClickLeft},null,8,["onClickLeft"]),(0,i._)("form",r,[(0,i.Wm)(x,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=function(e){return a.value=e}),shape:"round","show-action":""!=a.value,placeholder:"请输入搜索关键词",onSearch:a.onSearch,onCancel:a.onCancel},null,8,["modelValue","show-action","onSearch","onCancel"])]),(0,i.Wm)(F,{modelValue:a.refreshing,"onUpdate:modelValue":n[2]||(n[2]=function(e){return a.refreshing=e}),onRefresh:a.onRefresh},{default:(0,i.w5)((function(){return[(0,i.Wm)(_,{loading:a.loading,"onUpdate:loading":n[1]||(n[1]=function(e){return a.loading=e}),finished:a.finished,"finished-text":"没有更多了",onLoad:a.onLoad,class:"pull-box"},{default:(0,i.w5)((function(){return[l,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.userList,(function(n){return(0,i.wg)(),(0,i.j4)(C,{key:n.key},{default:(0,i.w5)((function(){return[(0,i._)("div",s,[(0,i._)("div",u,[(0,i._)("div",c,[(0,i.Wm)(S,{round:"",width:"48px",height:"48px",src:n.userIcon},null,8,["src"]),(0,i._)("img",{style:{width:"13px",height:"14px",position:"absolute",bottom:"7px",right:"0"},src:1==n.isAdmin?e.generalManageSign:2==n.isAdmin?e.superManageSign:"",alt:""},null,8,d),(0,i.kq)(' <div class="label-man" >\r\n                  <van-image v-if="item.sex==2" round width="13px" height="14px" :src="require(\'@/assets/manage/women.png\')" />\r\n                  <van-image v-if="item.sex==1" round width="13px" height="14px" :src="require(\'@/assets/manage/man.png\')" />\r\n              \r\n              </div> ')]),(0,i._)("div",v,[(0,i._)("div",f,(0,o.zw)(n.fullName)+" - "+(0,o.zw)(n.phone),1),(0,i._)("div",p,(0,o.zw)(n.laborName),1)])]),2!=n.isAdmin?((0,i.wg)(),(0,i.j4)(I,{key:0,class:(0,o.C_)(["fsize13",{plain:1==n.isForbiddenWords,color:0==n.isForbiddenWords}]),onClick:function(e){return a.showPopup(n)}},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,o.zw)(1==n.isAdmin&&0==n.isForbiddenWords?"解除管理并禁言":1==n.isForbiddenWords?"解除禁言":"禁言"),1)]})),_:2},1032,["class","onClick"])):(0,i.kq)("v-if",!0)])]})),_:2},1024)})),128))]})),_:1},8,["loading","finished","onLoad"])]})),_:1},8,["modelValue","onRefresh"]),(0,i.Wm)(R,{show:a.show,"onUpdate:show":n[4]||(n[4]=function(e){return a.show=e}),closeable:"",round:"",style:{width:"90vw"}},{default:(0,i.w5)((function(){return[(0,i._)("div",g,[h,(0,i._)("div",m,(0,o.zw)(a.currentPeople.label),1),(0,i.kq)(' <div >\r\n  <van-cell class="menu-box" title="选择要授予的管理员" is-link arrow-direction="down"  />\r\n        </div> '),(0,i._)("div",null,[(0,i.Wm)(I,{round:"",class:"plain",style:{width:"134px"},onClick:a.hidePopup},{default:(0,i.w5)((function(){return[A]})),_:1},8,["onClick"]),(0,i.Wm)(I,{loading:a.buttonLoading,disabled:a.buttonLoading,round:"",class:"color",style:{width:"134px","margin-left":"15px"},onClick:n[3]||(n[3]=function(e){return a.updateRole()})},{default:(0,i.w5)((function(){return[b]})),_:1},8,["loading","disabled"])])])]})),_:1},8,["show"])])}],["__scopeId","data-v-96226a50"]])},7872:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAcCAYAAAB/E6/TAAAAAXNSR0IArs4c6QAAAuRJREFUSEudllFIU2EUx//n7iZOFBb5YDAoyMCYlxIyeijYQLDdeigKXOidPhT5EFRQT/lgFPTSg9BDCULhBhkGFcGd9eIehB4ypt5FPhj5ICS0KMi2GfOe+GaW1u7dt92njf3P+X3n7Hz/ewhlnuBkUPXv8HYBOAPgIBH5GbxCwAwpdGc0YD4vl0P8Tm6iXiu8Zw30hIADzjqeYtDiag7Xxg+Zy046R1D3bNivKPQGQJPMicFIe75k2x+GkvlSekeQYYUfARSRgvwWMTAY18wb0qCz08FGT433ExGpFYIyS5nszmQoWfg3rmRFUSvcxaCxSiCbtO0xzZyWAhlz+k0QBqoBsYL+eMAclgOl9Qdg9FUFcvifSrbOsPQXAE5UCYrHNdOQq8jS3wNoqQYEcDKmJUKyoHsA+qsBMTAS18zzUqCet53NqFFSBKqvBLZuTRSSnjqRPJo+fpeZL1YCAvFQrDVxRfrCCmEkdWy3qpIlW5WoZjVHe538ztVURQupxiMm0HUwGJgpFOxTY20TixWb6kZA92z4sKLQa9cW2gUttv9V2k3jWtFGC7epyke3JJ5M1uvk2htxZUFRS7/EwJD7aTkyqiUeV1XRyVTQV696r4NxubyLs3gHDeSV3PB4ILlSdup633UG1mxPB4E7GAiWnjieWk9ER/5PyHlmSgp3gGJPxFtfzm5pXU9aP02MWxLT9cfHDDnjnSfwoGgrRef0C0y4L3kxl78XsvuEtkGtswD45eLoHPVYesp9+diaigt2CB7yEdFTOQgg7hkZlv4VgE8mSNz+pUxuu8+H+ga1TsRJPUUPNCydpdRFEU/FtMRR8cmwdNG6VtlYMtL6ZzAaZQIY+DsMFW1JvCBAt5lxlYCyGw8zF6BQBDbXEmEEoFqJAxYnr+gMfZPB2p++uhZSuFlRsIuAJhvURGA/xDuJ0AiGSLppmeQ8iNY3U+ZFgFYYEN+XGPYH2LTww87NP2tLfhOSXzl4FVtMDRN6AAAAAElFTkSuQmCC"},3476:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAcCAYAAAB/E6/TAAAAAXNSR0IArs4c6QAAAm1JREFUSEudljFoU1EUhr/TxhChYIQWKhQUrKCo4GDBQcFCRxdRsIvgoFjyKjWgkw4RBZdCS82zBgoughYEERfHDAUHBSMtmKGig2AgQh0ySElz5N6kavTlvfveXTLkP/fLuTnnP0eIOFogxRAXgPMoxxFGgAZQQZmVaV5G3WG+lzCRlthPk+fAsRDdCvAFuCketV66niBdYIR+3gLDLr8YWKPOmBT4GaTvDXrIU5RJR8i2rCAed5xBOssgGb4hpGKCvlNnjxRo/hsXmJH69s9/FhPSlrcYk2u8cwMVuYtwOxEIpsSj5AbyeQxcSggK/J+Cn67IK4QzCUFPxOOiW0ZFPiIcTAQSypJj3A3kswhMJQQtSY4rrqBR4D0wEBPWoMW4c9WZy9XnATAdCyTMS468c8Na0Bz7SLMaIytjtAd6+V24qfqMorYCowqjwiZnJW/NNfCEgmxmC5ygnzehT9jkqMywFqaJBrWf8HMoqM7OXq69HRcN8pkB5iOKYlI8lhNlpHNkSXML5bqDi5sZZLyxJJ6dvv+droy0yGGECZQJhNM9Ks5MVHNOBtxngGWUMileyxQfup5OFznHFvccquu3j6mL8SpVBGOyy6I+V4FHjo1ZY5NDVruD1c6i4hJ62YCM1YQtH90XtaxhZunjhQuho6mIFtlAyDoGNaizm10MkGbDMcbIGiYjjRGwIh6nbCP71p6OuMYaUB0YdAz4UwzxtqR1A7qPcsOhV0Bp2hWsjwywBPYz6lSBgu0jLZBhyBqnmUN7O0vjsK0qtTPJZGwu/XuZND3T3kzFmqmZRTWEr7T4hLLOFlXJ88NIfgFamLPr2z6seQAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=111.3f7b1c6d796105f04e01.js.map