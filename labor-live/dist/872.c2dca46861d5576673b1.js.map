{"version":3,"file":"872.c2dca46861d5576673b1.js","mappings":"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","sources":["webpack://labor-live/./src/utils/barrageTool.ts","webpack://labor-live/./src/utils/socket.ts","webpack://labor-live/./src/components/Present.vue?13cb","webpack://labor-live/./src/components/Present.vue?82a6","webpack://labor-live/./src/components/Present.vue?f1ce"],"sourcesContent":["/**\r\n * @desc 函数防抖\r\n * @param {需要防抖的函数} func\r\n * @param {延迟时间} wait\r\n*/\r\n\r\n// import { setTimeout } from \"core-js\";\r\n\r\nexport function debounce(func: Function, wait = 3000) {\r\n    //缓存一个定时器 id\r\n    let timer: any = null;\r\n    //这里返回的函数是每次用户实际调用的防抖函数\r\n    //如果已经设定过定时器了就清空上一次的定时器\r\n    //开始一个新的定时器，延迟执行用户传入的方法\r\n\r\n    // return function (...args: any) {\r\n    //     if (timer) clearTimeout(timer)\r\n    //     timer = setTimeout(() => {\r\n    //         func.apply(this, args)\r\n    //     }, wait)\r\n    // }\r\n\r\n    return function (this: any) {\r\n        let args = arguments;\r\n        if (timer) clearTimeout(timer)\r\n        timer = setTimeout(() => {\r\n            func.apply(this, args)\r\n        }, wait)\r\n    }\r\n}\r\n\r\n/**\r\n * @desc 是否滚到容器底部\r\n * @param {滚动容器} ele\r\n * @param {容器高度} wrapHeight\r\n*/\r\n\r\nexport function isScrollBottom(ele: any, wrapHeight: number, threshold = 30) {\r\n    const h1 = ele.scrollHeight - ele.scrollTop;\r\n    const h2 = wrapHeight + threshold;\r\n    const isBottom = h1 <= h2;\r\n    return isBottom\r\n}\r\n\r\n/**\r\n * 判断iphone型号\r\n * https://feizhaojun.com/?p=2650\r\n */\r\ndeclare const labor: any\r\nexport function getPhoneType() {\r\n    let isBigScreen = false; //默认iphone不是全面屏\r\n    let ua = window.navigator.userAgent;\r\n    let deviceScreen = window.screen.width + ',' + window.screen.height;\r\n    let iPhoneScreen = [\r\n        '375,812',  // X、XS、11 Pro\r\n        '414,896',  // XR、11、Xs Max、11 Pro Max\r\n        '390,844',  // 12、12 Pro\r\n        '428,926',  // 12 Pro Max\r\n    ]\r\n    //ua.indexOf('MicroMessenger') > -1\r\n    if ((ua.indexOf('MicroMessenger') > -1 || labor.isApp()) && !!ua.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/) && iPhoneScreen.indexOf(deviceScreen) > -1) {\r\n        isBigScreen = true;\r\n    }\r\n    return isBigScreen;\r\n}\r\n\r\n/**\r\n * 判断机型是普通屏幕还是全面屏幕\r\n */\r\nexport function judgeBigScreen() {  //这里根据返回值 true 或 false 返回true的话 则为全面屏\r\n    let result = false;\r\n    let rate = window.screen.height / window.screen.width;\r\n    let limit = window.screen.height == window.screen.availHeight ? 1.8 : 1.65; //临界判断值\r\n\r\n\r\n    //window.screen.height 为屏幕高度\r\n    //window.screen.availHeight 为浏览器 可用高度\r\n    if (rate > limit) {\r\n        result = true;\r\n    }\r\n\r\n    return result;\r\n\r\n}\r\n","import { userStore } from \"@/store/user\";\r\nimport { storeToRefs } from \"pinia\";\r\n/**\r\n * @description 封装socket方法\r\n */\r\n\r\nimport { Toast } from \"vant\";\r\n// const Base64 = require('js-base64').Base64\r\nimport { Base64 } from \"js-base64\"\r\n\r\ninterface socket {\r\n    websocket: any\r\n    connectURL: string\r\n    socket_open: boolean\r\n    hearbeat_timer: any\r\n    hearbeat_interval: number\r\n    is_reconnect: boolean\r\n    reconnect_count: number\r\n    reconnect_current: number\r\n    reconnect_number: number\r\n    reconnect_timer: any\r\n    reconnect_interval: number\r\n\r\n    init: (receiveMessage: Function | null) => any\r\n    receive: (message: any) => void\r\n    heartbeat: () => void\r\n    send: (data: any, callback?: any) => void\r\n    close: () => void\r\n    reconnect: () => void\r\n}\r\nconst store = userStore();\r\nconst { liveId, userId } = storeToRefs(store);\r\nconst socket: socket = {\r\n    websocket: null,\r\n    // connectURL: \"wss://websocket.qdszgh.cn:8443/jeecg-boot/liveWebsocket/\" + liveId.value + '/' + userId.value,\r\n    connectURL: \"wss://websocket.qdszgh.cn:8443/jeecg-boot/testLiveWebsocket/\" + liveId.value + '/' + userId.value,\r\n    //开启标识\r\n    socket_open: false,\r\n    //心跳timer\r\n    hearbeat_timer: null,\r\n    //心跳发送频率\r\n    hearbeat_interval: 60000,\r\n    //是否自动重连\r\n    is_reconnect: true,\r\n    //重连次数\r\n    reconnect_count: 3,\r\n    //已发起重连次数\r\n    reconnect_current: 1,\r\n    //网络错误提示此时\r\n    reconnect_number: 0,\r\n    //重连timer\r\n    reconnect_timer: null,\r\n    //重连频率\r\n    reconnect_interval: 5000,\r\n\r\n\r\n    init: (receiveMessage: Function | null) => {\r\n        if (!('WebSocket' in window)) {\r\n            Toast.fail(\"浏览器不支持websocket\");\r\n            return null\r\n        }\r\n        socket.websocket = new WebSocket(socket.connectURL)\r\n        socket.websocket.onmessage = (e: any) => {\r\n            if (receiveMessage) {\r\n                receiveMessage(e)\r\n            }\r\n        }\r\n\r\n        socket.websocket.onclose = (e: any) => {\r\n            clearInterval(socket.hearbeat_interval)\r\n            socket.socket_open = false;\r\n\r\n            //需要重新连接\r\n            if (socket.is_reconnect) {\r\n                socket.reconnect_timer = setTimeout(() => {\r\n                    //超过重连次数\r\n                    if (socket.reconnect_current > socket.reconnect_count) {\r\n                        clearTimeout(socket.reconnect_timer)\r\n                        socket.is_reconnect = false;\r\n                        return\r\n                    }\r\n\r\n\r\n                    //记录重连次数\r\n                    socket.reconnect_current++\r\n                    socket.reconnect()\r\n                }, socket.reconnect_interval)\r\n            }\r\n        }\r\n\r\n        //连接成功\r\n        socket.websocket.onopen = function () {\r\n            socket.socket_open = true\r\n            socket.is_reconnect = true\r\n            //开启心跳\r\n            socket.heartbeat()\r\n        }\r\n\r\n        //连接发生错误\r\n        socket.websocket.onerror = function () { }\r\n    },\r\n\r\n\r\n    send: (data, callback = null) => {\r\n        //开启状态直接发送\r\n        if (socket.websocket.readyState == socket.websocket.OPEN) {\r\n            socket.websocket.send(JSON.stringify(data))\r\n            if (callback) {\r\n                callback()\r\n            }\r\n\r\n            //正在开启状态，则等待1s后调用\r\n        } else {\r\n            clearInterval(socket.hearbeat_timer)\r\n            if (socket.reconnect_number < 1) { }\r\n            socket.reconnect_number++\r\n        }\r\n    },\r\n\r\n\r\n    receive: (message: any) => {\r\n        // let params = Base64.decode(JSON.parse(message.data).data)\r\n        let params = Base64.decode(JSON.parse(message.data))\r\n        params = JSON.parse(params)\r\n        return params\r\n    },\r\n\r\n    heartbeat: () => {\r\n        if (socket.hearbeat_timer) {\r\n            clearInterval(socket.hearbeat_timer)\r\n        }\r\n\r\n        socket.hearbeat_timer = setInterval(() => {\r\n            let data = {\r\n                content: 'ping'\r\n            }\r\n            let sendDara = {\r\n                encryption_type: 'base64',\r\n                data: Base64.encode(JSON.stringify(data))\r\n            }\r\n            socket.send(sendDara)\r\n        }, socket.hearbeat_interval)\r\n    },\r\n\r\n    close: () => {\r\n        clearInterval(socket.hearbeat_interval)\r\n        socket.is_reconnect = false\r\n        socket.websocket.close()\r\n    },\r\n\r\n\r\n    /**\r\n     * 重新连接\r\n     */\r\n\r\n    reconnect: () => {\r\n        if (socket.websocket && !socket.is_reconnect) {\r\n            socket.close()\r\n        }\r\n\r\n        socket.init(null)\r\n    }\r\n}\r\n\r\nexport default socket\r\n\r\n","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vShow as _vShow, withDirectives as _withDirectives, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, normalizeStyle as _normalizeStyle, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-4207be0e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"contentBox\" }\nconst _hoisted_2 = { class: \"content\" }\nconst _hoisted_3 = { class: \"content-top\" }\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"title\" }, \"赠送主播一个小礼物吧~\", -1 /* HOISTED */))\nconst _hoisted_5 = { class: \"information\" }\nconst _hoisted_6 = [\"onClick\"]\nconst _hoisted_7 = [\"src\"]\nconst _hoisted_8 = { class: \"price\" }\nconst _hoisted_9 = { class: \"gift-bottom\" }\nconst _hoisted_10 = /*#__PURE__*/_createTextVNode(\"赠送\")\nconst _hoisted_11 = { class: \"content-bottom\" }\nconst _hoisted_12 = { class: \"info\" }\nconst _hoisted_13 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"title\" }, \"剩余：\", -1 /* HOISTED */))\nconst _hoisted_14 = { class: \"number\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_van_button = _resolveComponent(\"van-button\")!\n\n  return (_ctx.showPresent)\n    ? (_openBlock(), _createElementBlock(\"div\", {\n        key: 0,\n        class: \"present animate__animated animate__fadeInUp\",\n        style: _normalizeStyle(_ctx.presentWindowHeight)\n      }, [\n        _createElementVNode(\"div\", _hoisted_1, [\n          _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"div\", _hoisted_3, [\n              _hoisted_4,\n              _createElementVNode(\"span\", {\n                class: \"close\",\n                onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onClose && _ctx.onClose(...args)))\n              }, \"关闭\")\n            ]),\n            _createElementVNode(\"div\", {\n              class: \"content-center\",\n              onTouchmove: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.handleTouch && _ctx.handleTouch(...args))),\n              style: _normalizeStyle(_ctx.presentListHeight)\n            }, [\n              _createElementVNode(\"div\", _hoisted_5, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.presentList, (item) => {\n                  return (_openBlock(), _createElementBlock(\"div\", {\n                    class: \"container\",\n                    key: item.id\n                  }, [\n                    _createElementVNode(\"div\", {\n                      class: \"gift\",\n                      onClick: ($event: any) => (_ctx.getActiveInfo(item.id))\n                    }, [\n                      _createElementVNode(\"div\", {\n                        class: _normalizeClass(['gift-top', item.id == _ctx.active ? 'active' : ''])\n                      }, [\n                        _createElementVNode(\"img\", {\n                          src: item.icon,\n                          alt: \"\"\n                        }, null, 8 /* PROPS */, _hoisted_7),\n                        _withDirectives(_createElementVNode(\"span\", { class: \"title\" }, _toDisplayString(item.name), 513 /* TEXT, NEED_PATCH */), [\n                          [_vShow, item.id != _ctx.active]\n                        ]),\n                        _createElementVNode(\"span\", _hoisted_8, _toDisplayString(item.coin) + \"金币\", 1 /* TEXT */)\n                      ], 2 /* CLASS */),\n                      _withDirectives(_createElementVNode(\"div\", _hoisted_9, [\n                        _createVNode(_component_van_button, {\n                          class: \"give\",\n                          onClick: ($event: any) => (_ctx.givePresent(item.id, item.coin))\n                        }, {\n                          default: _withCtx(() => [\n                            _hoisted_10\n                          ]),\n                          _: 2 /* DYNAMIC */\n                        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])\n                      ], 512 /* NEED_PATCH */), [\n                        [_vShow, item.id == _ctx.active]\n                      ])\n                    ], 8 /* PROPS */, _hoisted_6)\n                  ]))\n                }), 128 /* KEYED_FRAGMENT */))\n              ])\n            ], 36 /* STYLE, HYDRATE_EVENTS */),\n            _createElementVNode(\"div\", _hoisted_11, [\n              _createElementVNode(\"div\", _hoisted_12, [\n                _hoisted_13,\n                _createElementVNode(\"span\", _hoisted_14, _toDisplayString(_ctx.goldCoin) + \"金币\", 1 /* TEXT */)\n              ])\n            ])\n          ])\n        ])\n      ], 4 /* STYLE */))\n    : _createCommentVNode(\"v-if\", true)\n}","\r\nimport {\r\n  defineComponent,\r\n  getCurrentInstance,\r\n  reactive,\r\n  ref,\r\n  toRefs,\r\n  onMounted,\r\n  onUnmounted,\r\n  watch,\r\n} from \"vue\";\r\nimport { PresentListConfig } from \"@/types/present\";\r\nimport { userStore } from \"@/store/user\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport socket from \"@/utils/socket\";\r\nimport { Toast } from \"vant\";\r\nimport * as _ from \"lodash\";\r\nexport default defineComponent({\r\n  name: \"present\",\r\n  props: {\r\n    movieHeight: Number,\r\n    showPresent: Boolean,\r\n    equipmentHeight: Number,\r\n  },\r\n  setup(props: any, context: any) {\r\n    const { appContext } = getCurrentInstance() as any;\r\n    const axios = appContext.config.globalProperties.$axios;\r\n    const store = userStore();\r\n    const { laborApp } = storeToRefs(store);\r\n    const state = reactive({\r\n      presentWindowHeight: {\r\n        height: \"\",\r\n      },\r\n      presentListHeight: {\r\n        height: \"\",\r\n      },\r\n      presentList: ref<PresentListConfig[]>([]), //礼物列表\r\n      active: ref(\"\"), //默认没有选择礼物\r\n      goldCoin: ref<number>(0),\r\n      laborApp: true, //齐鲁工惠app环境\r\n    });\r\n    /**\r\n     * 礼物窗口、列表高度\r\n     */\r\n    function getPresentHeight(): any {\r\n      state.presentWindowHeight.height = props.equipmentHeight - props.movieHeight + \"px\";\r\n      state.presentListHeight.height =\r\n        props.equipmentHeight - props.movieHeight - 47 - 51 + \"px\";\r\n    }\r\n    watch(\r\n      () => props.showPresent,\r\n      (value) => {\r\n        window.addEventListener(\"resize\", getPresentHeight());\r\n      }\r\n    );\r\n    /**\r\n     * 礼物信息\r\n     */\r\n    function getPresentInfo() {\r\n      axios.get(axios.defaults.baseURL + \"/jeecg-boot/gift/api/list\").then((res: any) => {\r\n        if (res.data.code == 200) {\r\n          state.presentList = res.data.result;\r\n        }\r\n      });\r\n    }\r\n    getPresentInfo();\r\n    //获取我最新的金币\r\n    function getMyCoin() {\r\n      axios\r\n        .get(axios.defaults.baseURL + \"/jeecg-boot/user/api/getMyGoldCoin\")\r\n        .then((res: any) => {\r\n          if (res.data.code == 200) {\r\n            if (res.data.result) {\r\n              state.goldCoin = res.data.result;\r\n            }\r\n          }\r\n        });\r\n    }\r\n    function getActiveInfo(sort: any) {\r\n      state.active = sort;\r\n    }\r\n    function handleTouch(e: any) {\r\n      e._isScroller = true;\r\n    }\r\n    function onClose() {\r\n      state.active = \"\";\r\n      context.emit(\"closeGift\");\r\n    }\r\n\r\n    const givePresent = _.throttle(\r\n      (id: string, coin: number) => {\r\n        state.laborApp = laborApp.value;\r\n        if (state.laborApp) {\r\n          if (coin > state.goldCoin) {\r\n            Toast({\r\n              message: \"金币不足！\",\r\n              className: \"fail\",\r\n            });\r\n            return false;\r\n          }\r\n          interface Opt {\r\n            giftId: string;\r\n            pushType: string;\r\n          }\r\n          const opt: Opt = {\r\n            giftId: id,\r\n            pushType: \"3\",\r\n          };\r\n          socket.send(opt);\r\n          onClose();\r\n          Toast({\r\n            message: \"赠送成功！\",\r\n            className: \"success\",\r\n          });\r\n        } else {\r\n          Toast(\"解锁全部功能，请登录“齐鲁工惠app”观看直播\");\r\n        }\r\n      },\r\n      3000,\r\n      {\r\n        leading: true,\r\n        trailing: false,\r\n      }\r\n    );\r\n\r\n    onUnmounted(() => {\r\n      window.removeEventListener(\"resize\", getPresentHeight());\r\n    });\r\n    return {\r\n      ...toRefs(state),\r\n      getPresentHeight,\r\n      getPresentInfo,\r\n      getMyCoin,\r\n      getActiveInfo,\r\n      handleTouch,\r\n      onClose,\r\n      givePresent,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./Present.vue?vue&type=template&id=4207be0e&scoped=true&ts=true\"\nimport script from \"./Present.vue?vue&type=script&lang=ts\"\nexport * from \"./Present.vue?vue&type=script&lang=ts\"\n\nimport \"./Present.vue?vue&type=style&index=0&id=4207be0e&lang=scss&scoped=true\"\nimport \"./Present.vue?vue&type=style&index=1&id=4207be0e&lang=scss\"\n\nimport exportComponent from \"D:\\\\直播项目\\\\live\\\\frontEnd\\\\labor-live\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4207be0e\"]])\n\nexport default __exports__"],"names":["debounce","func","wait","timer","args","arguments","clearTimeout","setTimeout","apply","isScrollBottom","ele","wrapHeight","threshold","scrollHeight","scrollTop","getPhoneType","isBigScreen","ua","window","navigator","userAgent","deviceScreen","screen","width","height","indexOf","labor","isApp","match","store","liveId","userId","socket","websocket","connectURL","value","socket_open","hearbeat_timer","hearbeat_interval","is_reconnect","reconnect_count","reconnect_current","reconnect_number","reconnect_timer","reconnect_interval","init","receiveMessage","WebSocket","onmessage","e","onclose","clearInterval","reconnect","onopen","heartbeat","onerror","send","data","callback","readyState","OPEN","JSON","stringify","receive","message","params","parse","setInterval","sendDara","encryption_type","content","close","_withScopeId","n","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","name","props","movieHeight","Number","showPresent","Boolean","equipmentHeight","setup","context","axios","config","globalProperties","$axios","user","laborApp","state","presentWindowHeight","presentListHeight","presentList","active","goldCoin","getPresentHeight","getPresentInfo","get","defaults","baseURL","then","res","code","result","onClose","emit","addEventListener","givePresent","id","coin","className","opt","giftId","pushType","leading","trailing","removeEventListener","getMyCoin","getActiveInfo","sort","handleTouch","_isScroller","_ctx","_cache","$props","$setup","$data","$options","_component_van_button","key","style","onClick","onTouchmove","item","$event","src","icon","alt","default"],"sourceRoot":""}