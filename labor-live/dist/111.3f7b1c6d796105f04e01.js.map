{"version":3,"file":"111.3f7b1c6d796105f04e01.js","mappings":"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","sources":["webpack://labor-live/./src/utils/socket.ts","webpack://labor-live/./src/views/Manage/MuteManage.vue?6cba","webpack://labor-live/./src/views/Manage/MuteManage.vue?1459","webpack://labor-live/./src/views/Manage/MuteManage.vue?fea0"],"sourcesContent":["import { userStore } from \"@/store/user\";\r\nimport { storeToRefs } from \"pinia\";\r\n/**\r\n * @description 封装socket方法\r\n */\r\n\r\nimport { Toast } from \"vant\";\r\n// const Base64 = require('js-base64').Base64\r\nimport { Base64 } from \"js-base64\"\r\n\r\ninterface socket {\r\n    websocket: any\r\n    connectURL: string\r\n    socket_open: boolean\r\n    hearbeat_timer: any\r\n    hearbeat_interval: number\r\n    is_reconnect: boolean\r\n    reconnect_count: number\r\n    reconnect_current: number\r\n    reconnect_number: number\r\n    reconnect_timer: any\r\n    reconnect_interval: number\r\n\r\n    init: (receiveMessage: Function | null) => any\r\n    receive: (message: any) => void\r\n    heartbeat: () => void\r\n    send: (data: any, callback?: any) => void\r\n    close: () => void\r\n    reconnect: () => void\r\n}\r\nconst store = userStore();\r\nconst { liveId, userId } = storeToRefs(store);\r\nconst socket: socket = {\r\n    websocket: null,\r\n    // connectURL: \"wss://websocket.qdszgh.cn:8443/jeecg-boot/liveWebsocket/\" + liveId.value + '/' + userId.value,\r\n    connectURL: \"wss://websocket.qdszgh.cn:8443/jeecg-boot/testLiveWebsocket/\" + liveId.value + '/' + userId.value,\r\n    //开启标识\r\n    socket_open: false,\r\n    //心跳timer\r\n    hearbeat_timer: null,\r\n    //心跳发送频率\r\n    hearbeat_interval: 60000,\r\n    //是否自动重连\r\n    is_reconnect: true,\r\n    //重连次数\r\n    reconnect_count: 3,\r\n    //已发起重连次数\r\n    reconnect_current: 1,\r\n    //网络错误提示此时\r\n    reconnect_number: 0,\r\n    //重连timer\r\n    reconnect_timer: null,\r\n    //重连频率\r\n    reconnect_interval: 5000,\r\n\r\n\r\n    init: (receiveMessage: Function | null) => {\r\n        if (!('WebSocket' in window)) {\r\n            Toast.fail(\"浏览器不支持websocket\");\r\n            return null\r\n        }\r\n        socket.websocket = new WebSocket(socket.connectURL)\r\n        socket.websocket.onmessage = (e: any) => {\r\n            if (receiveMessage) {\r\n                receiveMessage(e)\r\n            }\r\n        }\r\n\r\n        socket.websocket.onclose = (e: any) => {\r\n            clearInterval(socket.hearbeat_interval)\r\n            socket.socket_open = false;\r\n\r\n            //需要重新连接\r\n            if (socket.is_reconnect) {\r\n                socket.reconnect_timer = setTimeout(() => {\r\n                    //超过重连次数\r\n                    if (socket.reconnect_current > socket.reconnect_count) {\r\n                        clearTimeout(socket.reconnect_timer)\r\n                        socket.is_reconnect = false;\r\n                        return\r\n                    }\r\n\r\n\r\n                    //记录重连次数\r\n                    socket.reconnect_current++\r\n                    socket.reconnect()\r\n                }, socket.reconnect_interval)\r\n            }\r\n        }\r\n\r\n        //连接成功\r\n        socket.websocket.onopen = function () {\r\n            socket.socket_open = true\r\n            socket.is_reconnect = true\r\n            //开启心跳\r\n            socket.heartbeat()\r\n        }\r\n\r\n        //连接发生错误\r\n        socket.websocket.onerror = function () { }\r\n    },\r\n\r\n\r\n    send: (data, callback = null) => {\r\n        //开启状态直接发送\r\n        if (socket.websocket.readyState == socket.websocket.OPEN) {\r\n            socket.websocket.send(JSON.stringify(data))\r\n            if (callback) {\r\n                callback()\r\n            }\r\n\r\n            //正在开启状态，则等待1s后调用\r\n        } else {\r\n            clearInterval(socket.hearbeat_timer)\r\n            if (socket.reconnect_number < 1) { }\r\n            socket.reconnect_number++\r\n        }\r\n    },\r\n\r\n\r\n    receive: (message: any) => {\r\n        // let params = Base64.decode(JSON.parse(message.data).data)\r\n        let params = Base64.decode(JSON.parse(message.data))\r\n        params = JSON.parse(params)\r\n        return params\r\n    },\r\n\r\n    heartbeat: () => {\r\n        if (socket.hearbeat_timer) {\r\n            clearInterval(socket.hearbeat_timer)\r\n        }\r\n\r\n        socket.hearbeat_timer = setInterval(() => {\r\n            let data = {\r\n                content: 'ping'\r\n            }\r\n            let sendDara = {\r\n                encryption_type: 'base64',\r\n                data: Base64.encode(JSON.stringify(data))\r\n            }\r\n            socket.send(sendDara)\r\n        }, socket.hearbeat_interval)\r\n    },\r\n\r\n    close: () => {\r\n        clearInterval(socket.hearbeat_interval)\r\n        socket.is_reconnect = false\r\n        socket.websocket.close()\r\n    },\r\n\r\n\r\n    /**\r\n     * 重新连接\r\n     */\r\n\r\n    reconnect: () => {\r\n        if (socket.websocket && !socket.is_reconnect) {\r\n            socket.close()\r\n        }\r\n\r\n        socket.init(null)\r\n    }\r\n}\r\n\r\nexport default socket\r\n\r\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, withCtx as _withCtx, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-96226a50\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { action: \"/\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { style: {\"height\":\"8px\",\"background\":\"#f5f5f5\"} }, null, -1 /* HOISTED */))\nconst _hoisted_3 = { style: {\"display\":\"flex\",\"align-items\":\"center\",\"justify-content\":\"space-between\"} }\nconst _hoisted_4 = { style: {\"display\":\"flex\"} }\nconst _hoisted_5 = { style: {\"position\":\"relative\"} }\nconst _hoisted_6 = [\"src\"]\nconst _hoisted_7 = { style: {\"margin-left\":\"12px\"} }\nconst _hoisted_8 = {\n  class: \"fsize14\",\n  style: {\"padding-top\":\"5px\"}\n}\nconst _hoisted_9 = {\n  class: \"fsize12\",\n  style: {\"margin-top\":\"12px\"}\n}\nconst _hoisted_10 = { style: {\"padding-bottom\":\"23px\",\"text-align\":\"center\"} }\nconst _hoisted_11 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"pop-title\" }, \"提示\", -1 /* HOISTED */))\nconst _hoisted_12 = { class: \"pop-content\" }\nconst _hoisted_13 = /*#__PURE__*/_createTextVNode(\"取消\")\nconst _hoisted_14 = /*#__PURE__*/_createTextVNode(\"确定\")\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_van_nav_bar = _resolveComponent(\"van-nav-bar\")!\n  const _component_van_search = _resolveComponent(\"van-search\")!\n  const _component_van_image = _resolveComponent(\"van-image\")!\n  const _component_van_button = _resolveComponent(\"van-button\")!\n  const _component_van_cell = _resolveComponent(\"van-cell\")!\n  const _component_van_list = _resolveComponent(\"van-list\")!\n  const _component_van_pull_refresh = _resolveComponent(\"van-pull-refresh\")!\n  const _component_van_popup = _resolveComponent(\"van-popup\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", null, [\n    _createVNode(_component_van_nav_bar, {\n      class: \"title\",\n      title: \"禁言管理\",\n      \"left-text\": \"\",\n      \"left-arrow\": \"\",\n      onClickLeft: $setup.onClickLeft\n    }, null, 8 /* PROPS */, [\"onClickLeft\"]),\n    _createElementVNode(\"form\", _hoisted_1, [\n      _createVNode(_component_van_search, {\n        modelValue: $setup.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (($setup.value) = $event)),\n        shape: \"round\",\n        \"show-action\": $setup.value != '',\n        placeholder: \"请输入搜索关键词\",\n        onSearch: $setup.onSearch,\n        onCancel: $setup.onCancel\n      }, null, 8 /* PROPS */, [\"modelValue\", \"show-action\", \"onSearch\", \"onCancel\"])\n    ]),\n    _createVNode(_component_van_pull_refresh, {\n      modelValue: $setup.refreshing,\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => (($setup.refreshing) = $event)),\n      onRefresh: $setup.onRefresh\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_van_list, {\n          loading: $setup.loading,\n          \"onUpdate:loading\": _cache[1] || (_cache[1] = ($event: any) => (($setup.loading) = $event)),\n          finished: $setup.finished,\n          \"finished-text\": \"没有更多了\",\n          onLoad: $setup.onLoad,\n          class: \"pull-box\"\n        }, {\n          default: _withCtx(() => [\n            _hoisted_2,\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.userList, (item) => {\n              return (_openBlock(), _createBlock(_component_van_cell, {\n                key: item.key\n              }, {\n                default: _withCtx(() => [\n                  _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"div\", _hoisted_4, [\n                      _createElementVNode(\"div\", _hoisted_5, [\n                        _createVNode(_component_van_image, {\n                          round: \"\",\n                          width: \"48px\",\n                          height: \"48px\",\n                          src: item.userIcon\n                        }, null, 8 /* PROPS */, [\"src\"]),\n                        _createElementVNode(\"img\", {\n                          style: {\"width\":\"13px\",\"height\":\"14px\",\"position\":\"absolute\",\"bottom\":\"7px\",\"right\":\"0\"},\n                          src: \r\n                    item.isAdmin == 1\r\n                      ? _ctx.generalManageSign\r\n                      : item.isAdmin == 2\r\n                      ? _ctx.superManageSign\r\n                      : ''\r\n                  ,\n                          alt: \"\"\n                        }, null, 8 /* PROPS */, _hoisted_6),\n                        _createCommentVNode(\" <div class=\\\"label-man\\\" >\\r\\n                  <van-image v-if=\\\"item.sex==2\\\" round width=\\\"13px\\\" height=\\\"14px\\\" :src=\\\"require('@/assets/manage/women.png')\\\" />\\r\\n                  <van-image v-if=\\\"item.sex==1\\\" round width=\\\"13px\\\" height=\\\"14px\\\" :src=\\\"require('@/assets/manage/man.png')\\\" />\\r\\n              \\r\\n              </div> \")\n                      ]),\n                      _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"div\", _hoisted_8, _toDisplayString(item.fullName) + \" - \" + _toDisplayString(item.phone), 1 /* TEXT */),\n                        _createElementVNode(\"div\", _hoisted_9, _toDisplayString(item.laborName), 1 /* TEXT */)\n                      ])\n                    ]),\n                    (item.isAdmin != 2)\n                      ? (_openBlock(), _createBlock(_component_van_button, {\n                          key: 0,\n                          class: _normalizeClass([\"fsize13\", {\r\n                plain: item.isForbiddenWords == 1,\r\n                color: item.isForbiddenWords == 0,\r\n              }]),\n                          onClick: ($event: any) => ($setup.showPopup(item))\n                        }, {\n                          default: _withCtx(() => [\n                            _createTextVNode(_toDisplayString(item.isAdmin == 1 && item.isForbiddenWords == 0\r\n                  ? \"解除管理并禁言\"\r\n                  : item.isForbiddenWords == 1\r\n                  ? \"解除禁言\"\r\n                  : \"禁言\"), 1 /* TEXT */)\n                          ]),\n                          _: 2 /* DYNAMIC */\n                        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"class\", \"onClick\"]))\n                      : _createCommentVNode(\"v-if\", true)\n                  ])\n                ]),\n                _: 2 /* DYNAMIC */\n              }, 1024 /* DYNAMIC_SLOTS */))\n            }), 128 /* KEYED_FRAGMENT */))\n          ]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"loading\", \"finished\", \"onLoad\"])\n      ]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\", \"onRefresh\"]),\n    _createVNode(_component_van_popup, {\n      show: $setup.show,\n      \"onUpdate:show\": _cache[4] || (_cache[4] = ($event: any) => (($setup.show) = $event)),\n      closeable: \"\",\n      round: \"\",\n      style: { width: '90vw' }\n    }, {\n      default: _withCtx(() => [\n        _createElementVNode(\"div\", _hoisted_10, [\n          _hoisted_11,\n          _createElementVNode(\"div\", _hoisted_12, _toDisplayString($setup.currentPeople.label), 1 /* TEXT */),\n          _createCommentVNode(\" <div >\\r\\n  <van-cell class=\\\"menu-box\\\" title=\\\"选择要授予的管理员\\\" is-link arrow-direction=\\\"down\\\"  />\\r\\n        </div> \"),\n          _createElementVNode(\"div\", null, [\n            _createVNode(_component_van_button, {\n              round: \"\",\n              class: \"plain\",\n              style: {\"width\":\"134px\"},\n              onClick: $setup.hidePopup\n            }, {\n              default: _withCtx(() => [\n                _hoisted_13\n              ]),\n              _: 1 /* STABLE */\n            }, 8 /* PROPS */, [\"onClick\"]),\n            _createVNode(_component_van_button, {\n              loading: $setup.buttonLoading,\n              disabled: $setup.buttonLoading,\n              round: \"\",\n              class: \"color\",\n              style: {\"width\":\"134px\",\"margin-left\":\"15px\"},\n              onClick: _cache[3] || (_cache[3] = ($event: any) => ($setup.updateRole()))\n            }, {\n              default: _withCtx(() => [\n                _hoisted_14\n              ]),\n              _: 1 /* STABLE */\n            }, 8 /* PROPS */, [\"loading\", \"disabled\"])\n          ])\n        ])\n      ]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"show\"])\n  ]))\n}","\r\nimport { ref, reactive, toRefs, onMounted, nextTick, getCurrentInstance } from \"vue\";\r\nimport { Toast } from \"vant\";\r\nimport socket from \"@/utils/socket\";\r\nimport { Base64 } from \"js-base64\";\r\nimport { get, post } from \"@/utils/request\";\r\nimport { userStore } from \"@/store/user\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport superManageSign from \"@/assets/super_manage_sign.png\";\r\nimport generalManageSign from \"@/assets/general_manage_sign.png\";\r\nexport default {\r\n  name: \"MuteManage\",\r\n  setup() {\r\n    const { appContext } = getCurrentInstance() as any;\r\n    const axios = appContext.config.globalProperties.$axios;\r\n    const store = userStore();\r\n    const { liveId } = storeToRefs(store);\r\n    const state = reactive({\r\n      superManageSign,\r\n      generalManageSign,\r\n      userList: <any[]>[], //评论列表\r\n      liveId: ref(\"\"),\r\n    });\r\n    // state.liveId = \"e5f303d9-97ec-6bc0-2fd8-8107ad15fa85\";\r\n    state.liveId = liveId.value;\r\n    // const value1 = ref(0);\r\n    const currentPeople = {\r\n      name: \"张先生\",\r\n      label: \"张先生\",\r\n      phone: \"133\",\r\n      userId: \"2222\",\r\n      action: 1,\r\n    };\r\n    const show = ref(false);\r\n    const value = ref(\"\");\r\n    const hidePopup = () => {\r\n      show.value = false;\r\n    };\r\n    const showPopup = (item: any) => {\r\n      show.value = true;\r\n      // currentPeople.action=item.label;\r\n      currentPeople.userId = item.userId;\r\n      currentPeople.name = item.fullName;\r\n\r\n      if (item.isForbiddenWords == 0 && item.isAdmin == 1) {\r\n        currentPeople.action = 1;\r\n        currentPeople.label = \"确定解除“\" + item.fullName + \"”的管理员身份，并禁言吗？\";\r\n      } else if (item.isForbiddenWords == 1) {\r\n        currentPeople.action = 2;\r\n        currentPeople.label = \"确定解除对“\" + item.fullName + \"”的禁言吗？\";\r\n      } else if (item.isForbiddenWords == 0) {\r\n        currentPeople.action = 3;\r\n        currentPeople.label = \"确定对“\" + item.fullName + \"”禁言吗？\";\r\n      }\r\n    };\r\n    const onClickLeft = () => history.back();\r\n    const updateRole = () => {\r\n      buttonLoading.value = true;\r\n      if (currentPeople.action == 1) {\r\n        //'确定解除“'+item.name+'”的管理员身份，并禁言吗？';\r\n        // 接口\r\n        resetMuteAdminRole(currentPeople.userId, \"3\");\r\n        // websocket------\r\n        //  enableMute(currentPeople.userId, \"3\");\r\n      } else if (currentPeople.action == 2) {\r\n        //'确定解除对“'+item.name+'”的禁言吗？';\r\n        resetMuteAdminRole(currentPeople.userId, \"5\");\r\n        // enableMute(currentPeople.userId, \"5\");\r\n      } else if (currentPeople.action == 3) {\r\n        //'确定对“'+item.name+'”禁言吗？';\r\n        resetMuteAdminRole(currentPeople.userId, \"1\");\r\n        // enableMute(currentPeople.userId, \"1\");\r\n      }\r\n    };\r\n    const resetMuteAdminRole = (userId: String, status: String) => {\r\n      console.log(userId + \"--\" + currentPeople.name);\r\n      let data = {\r\n        liveId: state.liveId,\r\n        sendType: status,\r\n        userId: userId,\r\n      };\r\n      post(axios.defaults.baseURL + \"/jeecg-boot/api/liveAdmin/edit\", data).then(\r\n        (res: any) => {\r\n          if (res.data.code == 200) {\r\n            buttonLoading.value = false;\r\n            hidePopup();\r\n            refreshing.value = true;\r\n            onRefresh();\r\n          } else if (res.data.code == 500) {\r\n            buttonLoading.value = false;\r\n            // hidePopup();\r\n            Toast(res.data.message);\r\n          }\r\n        }\r\n      );\r\n    };\r\n    const onSearch = (val: String) => {\r\n      let req = {\r\n        pageNo: 1,\r\n        pageSize: 10,\r\n        liveId: state.liveId,\r\n        // laborName: val,\r\n        // phone: val,\r\n        fullName: val,\r\n      };\r\n      state.userList = [];\r\n      loadData(req);\r\n    };\r\n    const onCancel = () => Toast(\"取消\");\r\n\r\n    const loading = ref(false);\r\n    const buttonLoading = ref(false);\r\n    const finished = ref(false);\r\n    const refreshing = ref(false);\r\n    const currentPage = ref(0);\r\n    const onLoad = () => {\r\n      if (refreshing.value) {\r\n        state.userList = [];\r\n        currentPage.value = 0;\r\n        refreshing.value = false;\r\n      }\r\n      currentPage.value++;\r\n      let req = {\r\n        pageNo: currentPage.value,\r\n        pageSize: 10,\r\n        liveId: state.liveId,\r\n      };\r\n      loadData(req);\r\n      // enableMute('hello')\r\n    };\r\n    function loadData(req: any) {\r\n      get(axios.defaults.baseURL + \"/jeecg-boot/api/liveAdmin/list\", req).then(\r\n        (res: any) => {\r\n          if (res.data.code == 200 && res.data.result) {\r\n            let data = res.data.result;\r\n\r\n            // data = {\r\n            //   current: 1,\r\n            //   pages: 1,\r\n            //   records: [\r\n            //     {\r\n            //       createBy: \"\",\r\n            //       createTime: \"\",\r\n            //       delFlag: 0,\r\n            //       fullName: \"测试\",\r\n            //       id: \"1223\",\r\n            //       isAdmin: \"1\",\r\n            //       isForbiddenWords: \"0\",\r\n            //       laborName: \"青岛工会\",\r\n            //       liveId: \"1523497318079721473\",\r\n            //       phone: \"136666\",\r\n            //       updateBy: \"\",\r\n            //       updateTime: \"2022-09-09\",\r\n            //       userIcon: \"https://qlgh.sdgh.org.cn/oss/download/path/mongofs/M00/26/30/CsgjO2EeYmaAfkDKAAOkq_-lWJM860_120x120.jpg\",\r\n            //       userId: \"56666533\",\r\n            //     },\r\n            //     {\r\n            //       createBy: \"\",\r\n            //       createTime: \"\",\r\n            //       delFlag: 0,\r\n            //       fullName: \"开发\",\r\n            //       id: \"1228\",\r\n            //       isAdmin: \"0\",\r\n            //       isForbiddenWords: \"1\",\r\n            //       laborName: \"青岛工会\",\r\n            //       liveId: \"1523497318079721473\",\r\n            //       phone: \"136666\",\r\n            //       updateBy: \"\",\r\n            //       updateTime: \"2022-09-09\",\r\n            //       userIcon: \"https://qlgh.sdgh.org.cn/oss/download/path/mongofs/M00/26/30/CsgjO2EeYmaAfkDKAAOkq_-lWJM860_120x120.jpg\",\r\n            //       userId: \"67856666533\",\r\n            //     },\r\n            //     {\r\n            //       createBy: \"\",\r\n            //       createTime: \"\",\r\n            //       delFlag: 0,\r\n            //       fullName: \"正式\",\r\n            //       id: \"1225399\",\r\n            //       isAdmin: \"0\",\r\n            //       isForbiddenWords: \"0\",\r\n            //       laborName: \"青岛工会\",\r\n            //       liveId: \"1523497318079721473\",\r\n            //       phone: \"136666\",\r\n            //       updateBy: \"\",\r\n            //       updateTime: \"2022-09-09\",\r\n            //       userIcon: \"https://qlgh.sdgh.org.cn/oss/download/path/mongofs/M00/26/30/CsgjO2EeYmaAfkDKAAOkq_-lWJM860_120x120.jpg\",\r\n            //       userId: \"967856666533\",\r\n            //     },\r\n            //   ],\r\n            //   size: 0,\r\n            //   total: 0,\r\n            // };\r\n\r\n            console.log(\"luckyList\", data);\r\n            let records = data.records;\r\n            if (records.length > 0) {\r\n              for (let i = 0; i < records.length; i++) {\r\n                state.userList.push(records[i]);\r\n              }\r\n            }\r\n\r\n            console.log(\"当前页：\" + currentPage.value);\r\n            loading.value = false;\r\n            if (currentPage.value >= data.pages) {\r\n              finished.value = true;\r\n            }\r\n          } else {\r\n            finished.value = true;\r\n            loading.value = false;\r\n          }\r\n        }\r\n      );\r\n    }\r\n    const onRefresh = () => {\r\n      finished.value = false;\r\n      loading.value = true;\r\n\r\n      onLoad();\r\n    };\r\n\r\n    // resetMuteAdminRole('8888', {mute:1});\r\n    onMounted(async () => {\r\n      // await initDom();\r\n      console.log(\"onmounted\");\r\n      //  socket.init(receiveMessage);\r\n      //\r\n    });\r\n    // 消息接收\r\n    async function receiveMessage(message: any) {\r\n      // const param = JSON.parse(Base64.decode(message.data));\r\n      const param = JSON.parse(message.data);\r\n      // 处理 赋值问题\r\n      const params = JSON.parse(JSON.stringify(param));\r\n\r\n      console.log(\"socket receiver:<<< \" + JSON.stringify(params));\r\n\r\n      interface Opt {\r\n        id: number;\r\n        avatar: string;\r\n        handlerName: string;\r\n        liveId: string;\r\n        message: string;\r\n        messageType: string;\r\n        pushType: string;\r\n        realname: string;\r\n      }\r\n\r\n      const opt: Opt = {\r\n        id: Date.now(),\r\n        avatar: params.avatar,\r\n        handlerName: param.handlerName,\r\n        liveId: param.liveId,\r\n        message: param.message,\r\n        messageType: param.messageType,\r\n        pushType: param.pushType,\r\n        realname: param.realname,\r\n      };\r\n      if (params.pushType == 2) {\r\n        await addTimeOut(opt);\r\n      }\r\n    }\r\n    function addTimeOut(opt: any) {\r\n      return new Promise((resolve, reject) => {\r\n        setTimeout(() => {\r\n          addUser(opt);\r\n          resolve(\"success\");\r\n        }, 500);\r\n      });\r\n    }\r\n    function addUser(data: any) {\r\n      console.log(\"socket receiver:<<<\" + JSON.stringify(data));\r\n      state.userList.push(data);\r\n      nextTick(() => {\r\n        finished.value = true;\r\n        loading.value = false;\r\n        // renderComment();\r\n      });\r\n    }\r\n\r\n    //禁言管理\r\n    async function enableMute(uid: string, type: string) {\r\n      interface Opt {\r\n        liveId: string;\r\n        userId: string;\r\n        sendType: string;\r\n        pushType: string;\r\n      }\r\n      const opt: Opt = {\r\n        liveId: state.liveId,\r\n        userId: uid,\r\n        sendType: type,\r\n        pushType: \"2\",\r\n      };\r\n\r\n      socket.send(opt);\r\n      setTimeout(() => {\r\n        buttonLoading.value = false;\r\n        hidePopup();\r\n        refreshing.value = true;\r\n        onRefresh();\r\n      }, 500);\r\n    }\r\n    return {\r\n      ...toRefs(state),\r\n      receiveMessage,\r\n      addTimeOut,\r\n      addUser,\r\n      enableMute,\r\n      loadData,\r\n      currentPage,\r\n      onClickLeft,\r\n      value,\r\n      onSearch,\r\n      onCancel,\r\n      currentPeople,\r\n      onLoad,\r\n      loading,\r\n      buttonLoading,\r\n      finished,\r\n      onRefresh,\r\n      refreshing,\r\n      show,\r\n      showPopup,\r\n      hidePopup,\r\n      updateRole,\r\n    };\r\n  },\r\n};\r\n","import { render } from \"./MuteManage.vue?vue&type=template&id=96226a50&scoped=true&ts=true\"\nimport script from \"./MuteManage.vue?vue&type=script&lang=ts\"\nexport * from \"./MuteManage.vue?vue&type=script&lang=ts\"\n\nimport \"./MuteManage.vue?vue&type=style&index=0&id=96226a50&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\直播项目\\\\live\\\\frontEnd\\\\labor-live\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-96226a50\"]])\n\nexport default __exports__"],"names":["store","liveId","userId","socket","websocket","connectURL","value","socket_open","hearbeat_timer","hearbeat_interval","is_reconnect","reconnect_count","reconnect_current","reconnect_number","reconnect_timer","reconnect_interval","init","receiveMessage","window","WebSocket","onmessage","e","onclose","clearInterval","setTimeout","clearTimeout","reconnect","onopen","heartbeat","onerror","send","data","callback","readyState","OPEN","JSON","stringify","receive","message","params","parse","setInterval","sendDara","encryption_type","content","close","_withScopeId","n","_hoisted_1","action","_hoisted_2","_","style","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","class","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","name","setup","axios","config","globalProperties","$axios","user","state","superManageSign","generalManageSign","userList","currentPeople","label","phone","show","hidePopup","resetMuteAdminRole","status","console","log","sendType","defaults","baseURL","then","res","code","buttonLoading","refreshing","onRefresh","loading","finished","currentPage","onLoad","loadData","pageNo","pageSize","req","result","records","length","i","push","pages","addTimeOut","opt","Promise","resolve","reject","addUser","param","id","Date","now","avatar","handlerName","messageType","pushType","realname","enableMute","uid","type","onClickLeft","history","back","onSearch","val","fullName","onCancel","showPopup","item","isForbiddenWords","isAdmin","updateRole","_ctx","_cache","$props","$setup","$data","$options","_component_van_nav_bar","_component_van_search","_component_van_image","_component_van_button","_component_van_cell","_component_van_list","_component_van_pull_refresh","_component_van_popup","title","modelValue","$event","shape","placeholder","default","key","round","width","height","src","userIcon","alt","laborName","plain","color","onClick","closeable","disabled"],"sourceRoot":""}