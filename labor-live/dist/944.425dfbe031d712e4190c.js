"use strict";(self.webpackChunklabor_live=self.webpackChunklabor_live||[]).push([[944],{5296:(e,t,n)=>{n.d(t,{Z:()=>f});var i=n(5759),o=n(5684),a=n(1751),r=(n(4333),n(2300)),l=(0,i.H)(),s=(0,o.Jk)(l),c=s.liveId,u=s.userId,d={websocket:null,connectURL:"wss://websocket.qdszgh.cn:8443/jeecg-boot/testLiveWebsocket/"+c.value+"/"+u.value,socket_open:!1,hearbeat_timer:null,hearbeat_interval:6e4,is_reconnect:!0,reconnect_count:3,reconnect_current:1,reconnect_number:0,reconnect_timer:null,reconnect_interval:5e3,init:function(e){if(!("WebSocket"in window))return a.Z.fail("浏览器不支持websocket"),null;d.websocket=new WebSocket(d.connectURL),d.websocket.onmessage=function(t){e&&e(t)},d.websocket.onclose=function(e){clearInterval(d.hearbeat_interval),d.socket_open=!1,d.is_reconnect&&(d.reconnect_timer=setTimeout((function(){if(d.reconnect_current>d.reconnect_count)return clearTimeout(d.reconnect_timer),void(d.is_reconnect=!1);d.reconnect_current++,d.reconnect()}),d.reconnect_interval))},d.websocket.onopen=function(){d.socket_open=!0,d.is_reconnect=!0,d.heartbeat()},d.websocket.onerror=function(){}},send:function(e,t){void 0===t&&(t=null),d.websocket.readyState==d.websocket.OPEN?(d.websocket.send(JSON.stringify(e)),t&&t()):(clearInterval(d.hearbeat_timer),d.reconnect_number,d.reconnect_number++)},receive:function(e){var t=r.DS.decode(JSON.parse(e.data));return t=JSON.parse(t)},heartbeat:function(){d.hearbeat_timer&&clearInterval(d.hearbeat_timer),d.hearbeat_timer=setInterval((function(){var e={encryption_type:"base64",data:r.DS.encode(JSON.stringify({content:"ping"}))};d.send(e)}),d.hearbeat_interval)},close:function(){clearInterval(d.hearbeat_interval),d.is_reconnect=!1,d.websocket.close()},reconnect:function(){d.websocket&&!d.is_reconnect&&d.close(),d.init(null)}};const f=d},5944:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var i=n(6252),o=n(3577),a=function(e){return(0,i.dD)("data-v-6e58b550"),e=e(),(0,i.Cn)(),e},r={class:"content"},l=a((function(){return(0,i._)("div",{style:{height:"8px",background:"#f5f5f5"}},null,-1)})),s={style:{display:"flex","align-items":"center","justify-content":"space-between"}},c={style:{display:"flex"}},u={style:{"margin-left":"12px"}},d={class:"fsize14",style:{"padding-top":"5px"}},f=(0,i.Uk)(" 拼手气福袋 "),v={key:0,style:{color:"#999999"}},p={class:"fsize12 overtext",style:{"margin-top":"12px"}},g={style:{display:"flex","align-items":"center","justify-content":"space-between"}},b={style:{display:"flex"}},_={style:{"margin-left":"12px"}},h={class:"fsize14",style:{"padding-top":"5px"}},w=(0,i.Uk)(" 幸运抽奖 "),k={class:"fsize12",style:{"margin-top":"12px"}},y={class:"overtext"},m=["onClick"],z={style:{"padding-bottom":"23px","text-align":"center","padding-left":"20px","padding-right":"20px"}},L=a((function(){return(0,i._)("div",{class:"pop-title"},"奖项设置",-1)})),S=a((function(){return(0,i._)("div",{class:"pop-content fsize14",style:{display:"flex","justify-content":"space-around"}},[(0,i._)("div",{style:{display:"inline-block","padding-right":"20px"}},"奖项名称"),(0,i._)("div",{style:{display:"inline-block","padding-right":"20px"}},"奖品数量"),(0,i.Uk)(" 奖品内容 ")],-1)})),x={class:"fsize14"},I={class:"listfront"},C={class:"listfront"},P={class:"listfront"};var T=n(655),U=n(2262),D=n(4949),H=n(1610),j=n(5296),B=n(1751),N=(n(4333),n(5759)),W=n(5684);const J=(0,i.aZ)({name:"turnplateManage",setup:function(e,t){var n=this,o=(0,i.FN)().appContext.config.globalProperties.$axios,a=(0,N.H)(),r=(0,W.Jk)(a).liveId,l=(0,U.qj)({luckyList:[],offerList:[],prizeList:[],activeId:(0,U.iH)(""),currentPage:(0,U.iH)(0),sizePage:(0,U.iH)(10),totalPage:(0,U.iH)(0),show:!1,leftTime:(0,U.iH)(0),leftTimeLabel:(0,U.iH)(""),liveId:(0,U.iH)("")});l.liveId=r.value;var s=function(e){console.log("奖项设置："+e),l.offerList=[],l.offerList=e},c=(0,U.iH)(!1),u=(0,U.iH)(!1),d=(0,U.iH)(!1),f=(0,D.tv)(),v=function(e,t){var n={goodBagId:e,liveId:t};console.log("启用福袋"+JSON.stringify(n)),(0,H.U2)(o.defaults.baseURL+"/jeecg-boot/goodBag/api/enableGoodBag",n).then((function(e){200!=e.data.code&&500!=e.data.code||setTimeout((function(){l.activeId="",d.value=!0,b(),(0,B.Z)(e.data.message)}),500)}))};function p(){var e={pageNo:l.currentPage,pageSize:10,liveId:l.liveId};(0,H.U2)(o.defaults.baseURL+"/jeecg-boot/goodBag/api/goodBagList",e).then((function(e){if(200==e.data.code&&e.data.result){var t=e.data.result;console.log("luckyList",t);var n=t;if(n.length>0)for(var i=0;i<n.length;i++)l.luckyList.push(n[i]);console.log("当前页："+l.currentPage),c.value=!1,u.value=!0}else u.value=!0,c.value=!1}))}var g=function(){d.value&&(l.luckyList=[],l.prizeList=[],l.currentPage=0,d.value=!1),l.currentPage++,p()},b=function(){u.value=!1,c.value=!0,g()};function _(e){l.luckyList.push(e),(0,i.Y3)((function(){u.value=!0,c.value=!1}))}return(0,i.bv)((function(){return(0,T.mG)(n,void 0,void 0,(function(){return(0,T.Jh)(this,(function(e){return[2]}))}))})),(0,T.pi)((0,T.pi)({},(0,U.BK)(l)),{enableGoodBag:v,socketEnableBag:function(e,t){return(0,T.mG)(this,void 0,void 0,(function(){var n;return(0,T.Jh)(this,(function(i){switch(i.label){case 0:return n={liveId:e,liveGoodBagId:t,pushType:"1",sendMessageType:"1"},[4,j.Z.send(n)];case 1:return i.sent(),[2]}}))}))},onClickLeft:function(){return history.back()},onLoad:g,loading:c,finished:u,refreshing:d,onRefresh:b,showPopup:function(e){l.show=!0,s(e)},start:function(e){0==e.status?(l.activeId=e.id,v(e.id,e.liveId)):2==e.status?f.push("/winUser/"+e.id):1==e.status&&f.push("/joinUser/"+e.id)},router:f,getPrizeList:s,loadPrize:function(){var e={pageNo:l.currentPage,pageSize:10,liveId:l.liveId};(0,H.U2)(o.defaults.baseURL+"/jeecg-boot/LiveActivity/liveActivity/list",e).then((function(e){if(200==e.data.code&&e.data.result){var t=e.data.result;console.log("prizeList",t);var n=t.records;if(n.length>0)for(var i=0;i<n.length;i++)l.prizeList.push(n[i]);console.log("当前页："+l.currentPage),c.value=!1,l.currentPage>=t.pages&&(u.value=!0)}else u.value=!0,c.value=!1}))},loadGoodBag:p,addGoodBag:_,countDown:function(e){var t=e-Math.round((new Date).getTime());return console.log(new Date(e).toLocaleString()+"结束时间："+t),t<0&&(t=0),console.log("n结束时间："+t),t},addZero:function(e){return e<10?"0"+e:e+""},onFinish:function(){setTimeout((function(){l.activeId="",d.value=!0,b()}),200)}})}});const R=(0,n(3744).Z)(J,[["render",function(e,t,n,a,T,U){var D=(0,i.up)("van-nav-bar"),H=(0,i.up)("van-count-down"),j=(0,i.up)("van-button"),B=(0,i.up)("van-cell"),N=(0,i.up)("van-list"),W=(0,i.up)("van-pull-refresh"),J=(0,i.up)("van-popup");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(D,{class:"title",title:"抽奖管理","left-text":"","left-arrow":"",onClickLeft:e.onClickLeft},null,8,["onClickLeft"]),(0,i.Wm)(W,{modelValue:e.refreshing,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.refreshing=t}),onRefresh:e.onRefresh},{default:(0,i.w5)((function(){return[(0,i.Wm)(N,{loading:e.loading,"onUpdate:loading":t[0]||(t[0]=function(t){return e.loading=t}),finished:e.finished,"finished-text":"没有更多了",onLoad:e.onLoad,class:"pull-box"},{default:(0,i.w5)((function(){return[l,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.luckyList,(function(t){return(0,i.wg)(),(0,i.j4)(B,{key:t.id},{default:(0,i.w5)((function(){return[(0,i._)("div",s,[(0,i._)("div",c,[(0,i._)("div",u,[(0,i._)("div",d,[f,(0,i._)("div",{class:(0,o.C_)(["fuda-label",{blue:0==t.status,green:1==t.status,red:2==t.status}])},[(0,i.Uk)((0,o.zw)(0==t.status?"未启用":1==t.status?"进行中":"已结束")+" ",1),1==t.status&&e.countDown(t.bagDrawPrizeTimeLong)>0?((0,i.wg)(),(0,i.iD)("span",v,[(0,i.kq)(" {{leftTimeLabel}} "),(0,i.Wm)(H,{format:"mm:ss",onFinish:e.onFinish,time:e.countDown(t.bagDrawPrizeTimeLong),style:{display:"inline-block"}},null,8,["onFinish","time"])])):(0,i.kq)("v-if",!0)],2)]),(0,i._)("div",p,(0,o.zw)(t.goldCoin)+"金币*"+(0,o.zw)(t.winPrizeQuantity)+"个，计时"+(0,o.zw)(t.countDownLabel),1),(0,i.kq)(' <div\r\n                    class="fuda-label red bottom-line"\r\n                    @click="showPopup(item)"\r\n                    v-if="item.pushType == 0"\r\n                  >\r\n                    奖项设置\r\n                  </div> ')])]),(0,i.Wm)(j,{class:(0,o.C_)(["fsize13 plain",{color:0==t.status}]),loading:t.id==e.activeId,onClick:function(n){return e.start(t)}},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,o.zw)(0==t.status?"启用":1==t.status?"查看参与名单":"查看中奖名单"),1)]})),_:2},1032,["class","loading","onClick"])])]})),_:2},1024)})),128)),(0,i.kq)(' <div style="height: 35px; background: #f5f5f5"></div> '),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.prizeList,(function(t){return(0,i.wg)(),(0,i.j4)(B,{key:t.id},{default:(0,i.w5)((function(){return[(0,i._)("div",g,[(0,i._)("div",b,[(0,i._)("div",_,[(0,i._)("div",h,[w,(0,i._)("div",{class:(0,o.C_)(["fuda-label",{blue:0==t.prizeSumSurplus,green:1==t.prizeSumSurplus,red:2==t.prizeSumSurplus}])},(0,o.zw)(0==t.activityState?"未启用":1==t.activityState?"进行中":2==t.activityState?"已结束":"已关闭"),3)]),(0,i._)("div",k,[(0,i._)("div",y,"奖品数量："+(0,o.zw)(t.drawNumber)+"个",1),(0,i._)("div",{class:"fuda-label red bottom-line",onClick:function(n){return e.showPopup(t.prizeList)}}," 奖项设置 ",8,m)])])]),(0,i.Wm)(j,{class:(0,o.C_)(["fsize13",{plain:t.prizeSumSurplus>0,color:0==t.prizeSumSurplus}]),loading:t.id==e.activeId,onClick:function(n){return e.start(t)}},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,o.zw)(0==t.prizeSumSurplus?"启用":"查看中奖名单"),1)]})),_:2},1032,["class","loading","onClick"])])]})),_:2},1024)})),128))]})),_:1},8,["loading","finished","onLoad"])]})),_:1},8,["modelValue","onRefresh"]),(0,i.Wm)(J,{show:e.show,"onUpdate:show":t[2]||(t[2]=function(t){return e.show=t}),closeable:"",round:"",style:{width:"90vw"}},{default:(0,i.w5)((function(){return[(0,i._)("div",z,[L,S,(0,i._)("div",x,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.offerList,(function(e){return(0,i.wg)(),(0,i.iD)("div",{key:e.key},[(0,i._)("div",{style:{display:"flex"},class:(0,o.C_)(["ofcolor1",{ofcolor0:0==e.prizeType,ofcolor2:2==e.prizeType,ofcolor1:1==e.prizeType,ofcolor3:3==e.prizeType}])},[(0,i._)("div",I,(0,o.zw)(e.prizeType_dictText),1),(0,i._)("div",C,(0,o.zw)(e.prizeSum),1),(0,i._)("div",P,(0,o.zw)(e.prizeTitle),1)],2)])})),128))])])]})),_:1},8,["show"])])}],["__scopeId","data-v-6e58b550"]])}}]);
//# sourceMappingURL=944.425dfbe031d712e4190c.js.map